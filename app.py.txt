import streamlit as st
from transformers import pipeline
import PyPDF2

# Load model
@st.cache_resource
def load_model():
    return pipeline("summarization", model="facebook/bart-large-cnn")

summarizer = load_model()

st.set_page_config(page_title="ReviseAI", layout="centered")
st.title("ðŸ“˜ ReviseAI â€“ Smart Study Summarizer")

uploaded_file = st.file_uploader("Upload PDF file", type="pdf")
summary_length = st.selectbox("Select Summary Length", ["Very Short", "Short", "Medium"])

def extract_text(pdf_file):
    reader = PyPDF2.PdfReader(pdf_file)
    text = ""
    for page in reader.pages:
        if page.extract_text():
            text += page.extract_text()
    return text

def summarize_text(text, length):
    if length == "Very Short":
        max_len, min_len = 80, 20
    elif length == "Medium":
        max_len, min_len = 200, 80
    else:
        max_len, min_len = 130, 40

    summary = summarizer(text[:3000], max_length=max_len, min_length=min_len, do_sample=False)
    return summary[0]["summary_text"]

if uploaded_file:
    with st.spinner("Summarizing document..."):
        text = extract_text(uploaded_file)
        summary = summarize_text(text, summary_length)

    st.subheader("ðŸ“Œ Key Points Summary")
    points = summary.split(". ")
    for p in points:
        st.markdown(f"- {p.strip()}")
